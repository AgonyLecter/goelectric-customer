<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controllo Noleggio Scooter</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="logo.ico">

    <style>
        body { padding-top: 20px; }
        #logo { max-width: 200px; margin-bottom: 20px; }
        .help-button { position: fixed; bottom: 20px; right: 20px; font-size: 24px; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <select id="languageSelect" class="form-select mb-3" onchange="changeLanguage()">
            <option value="EN">English</option>
            <option value="FR">Fran√ßais</option>
            <option value="IT">Italiano</option>
            <option value="DE">Deutsch</option>
        </select>
        <div class="row justify-content-center">
            <div class="col-12 text-center">
                <img src="logo.png" alt="Logo" id="logo" class="img-fluid">
            </div>
            <div class="col-12 col-md-8 col-lg-6">
                <h1 id="mainTitle" class="mb-3 text-center">Verify Scooter Status</h1>
                <div class="mb-3">
                    <label for="scooterCodeInput" id="inputLabel" class="form-label">Enter Scooter Code</label>
                    <input type="text" class="form-control" id="scooterCodeInput" placeholder="Scooter Code">
                </div>
                <button class="btn btn-primary w-100" onclick="checkScooterStatus()">Verify</button>
                <div id="scooterDetails" class="mt-4 hidden">
                    <h3>Details</h3>
                    <p><strong>Name:</strong> <span id="scooterName"></span></p>
                    <p><strong>Return Date:</strong> <span id="scooterReturnDate"></span></p>
                    <p><strong>Return Time:</strong> <span id="scooterReturnTime"></span></p>
                    <p><strong>Status:</strong> <span id="scooterStatus"></span></p>
                </div>
                <a href="tel:+1234567890" class="help-button text-primary">
                    <i class="fas fa-phone-alt"></i>
                </a>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-database.js"></script>
    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyC346gJHt-Dg7_bjzYw7k1D6j0tcalxht4",
            authDomain: "goelectric-e9299.firebaseapp.com",
            databaseURL: "https://goelectric-e9299-default-rtdb.firebaseio.com",
            projectId: "goelectric-e9299",
            storageBucket: "goelectric-e9299.appspot.com",
            messagingSenderId: "81618360543",
            appId: "1:81618360543:web:67a9a4d38ec18400c1316a",
            measurementId: "G-6FZQSDWEZJ"
        };
        firebase.initializeApp(firebaseConfig);

        const dbRef = firebase.database().ref('scooters');

        function checkScooterStatus() {
            var codeInput = document.getElementById('scooterCodeInput').value;
            dbRef.orderByChild('code').equalTo(codeInput).once('value', snapshot => {
                if (snapshot.exists()) {
                    snapshot.forEach(function(childSnapshot) {
                        var scooter = childSnapshot.val();
                        document.getElementById('scooterName').textContent = scooter.name;
                        document.getElementById('scooterReturnDate').textContent = scooter.returnDate;
                        document.getElementById('scooterReturnTime').textContent = scooter.returnTime;
                        document.getElementById('scooterStatus').textContent = scooter.status;
                        document.getElementById('scooterDetails').classList.remove('hidden');
                    });
                } else {
                    alert('No scooter found with this code.');
                }
            });
        }

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js').then(function(registration) {
                console.log('Service Worker registered with scope:', registration.scope);
            }).catch(function(err) {
                console.log('Service Worker registration failed:', err);
            });
        }
    </script>
</body>
</html>
